<div class="flex flex-col lg:flex-row gap-6 p-2">

    <div class="lg:grow lg:w-2/3 w-full">
        <div class="bg-slate-200 rounded-2xl shadow-xl flex flex-col">
            <div class="flex items-center rounded-t-2xl justify-between bg-linear-to-br from-yellow-500 to-yellow-400 px-4 py-2 flex-wrap">
                <h2 class="hidden sm:block text-xl font-bold text-slate-800">
                    Workout list
                </h2>

                <div class="flex gap-2 flex-wrap justify-center my-2 sm:my-0">

                    <div>
                        <input
                        [(ngModel)]="search"
                        (input)="onSearchChange($event.target.value)"
                        type="text"
                        placeholder="Enter workout name..."
                        class="rounded-lg px-3 py-1.5 bg-slate-300 text-sm font-semibold focus:outline-none"
                        />
                    </div>

                    <select
                    (change)="loadWorkoutsByQuery()"
                    [(ngModel)]="sort"
                    class="rounded-lg px-3 py-1.5 bg-slate-300 text-sm font-semibold focus:outline-none"
                    >
                    <option selected disabled hidden>{{workoutService.getQueryParams().sort}}</option>
                    <option value="Newest">Newest</option>
                    <option value="Oldest">Oldest</option>
                </select>

                <input
                [(ngModel)]="date"
                (input)="loadWorkoutsByQuery()"
                type="date"
                class="rounded-lg px-3 py-1.5 bg-slate-300 text-sm font-semibold focus:outline-none"
                />
            </div>
        </div>
        @if(workouts().length === 0) {
            <div class="flex justify-center items-center py-20">
                <h1 class="text-4xl text-slate-800 font-semibold">No workouts added</h1>
            </div>
        }
        <div class="p-4 overflow-y-auto">


            <div class="flex flex-wrap gap-3">

                @for (workout of workouts(); track workout.id) {
                    <div
                    (click)="isModalOpen.set(true)"
                    (click)="selectedWorkout = workout"
                    [class]="getWorkoutCardClass()"
                    class="flex items-center bg-slate-300 rounded-xl px-4 py-3 hover:bg-slate-400 hover:scale-[1.01] transition cursor-pointer group shadow-md">

                    <div class="flex flex-col flex-1">
                        <p class="font-semibold text-slate-900 group-hover:underline">
                            {{ workout.name }}
                        </p>
                        <p class="text-sm text-slate-700">
                            {{ workout.exerciseCount }} exercises
                        </p>
                    </div>

                    <div class="flex items-center gap-4 text-sm font-semibold">
                        <span
                        [class]="getSetsBadgeClass(workout.setCount)"
                        class="px-2 py-0.5 rounded-full text-slate-900">
                        {{ workout.setCount }} sets
                    </span>
                    <span class="text-emerald-700">
                        {{workout.workoutDate | date}}
                    </span>
                </div>
            </div>
        }
    </div>

</div>
<!-- @if(workouts.length > 0) {
    <div class="border-b-2 border-yellow-500 my-4 w-[80%] mx-auto"></div>

    <div class="flex flex-row gap-2 justify-center items-center py-2">
        <button class="px-3 py-1.5 font-semibold rounded-lg bg-slate-300 text-sm hover:bg-slate-400 shadow-sm transition">
            <
        </button>

        <button class="px-3 py-1.5 rounded-lg bg-yellow-500 text-sm font-bold shadow-sm">
            1
        </button>

        <button class="px-3 py-1.5 rounded-lg bg-slate-300 text-sm hover:bg-slate-400 shadow-sm transition">
            2
        </button>

        <button class="px-3 py-1.5 rounded-lg bg-slate-300 text-sm hover:bg-slate-400 shadow-sm transition">
            3
        </button>

        <button class="px-3 py-1.5 rounded-lg bg-slate-300 text-sm hover:bg-slate-400 shadow-sm transition">
            4
        </button>

        <button class="px-3 font-semibold py-1.5 rounded-lg bg-slate-300 text-sm hover:bg-slate-400 shadow-sm transition">
            >
        </button>
    </div>
} -->
</div>
</div>

<div class="lg:w-1/3 w-full">
    <div class="flex flex-col h-auto">
        <div class="flex rounded-t-2xl bg-linear-to-br from-yellow-400 to-yellow-500 w-full px-4 py-2 font-bold">
            <h1 class="text-xl text-slate-800">Summary</h1>
        </div>

        <div class="bg-slate-200 rounded-b-2xl p-4 shadow-2xl">
            <div class="flex flex-col gap-4">
                <div class="bg-slate-300 rounded-xl p-4 shadow-md">
                    <p class="text-sm text-slate-600 font-semibold">
                        workouts
                    </p>
                    <p class="text-2xl font-bold text-slate-900">
                        {{workouts().length}}
                    </p>
                </div>

                <div class="bg-slate-300 rounded-xl p-4 shadow-md">
                    <p class="text-sm text-slate-600 font-semibold">
                        exercises
                    </p>
                    <p class="text-2xl font-bold text-slate-900">
                        {{workoutSummary()?.exerciseCount ?? 0}}
                    </p>
                </div>

                <div class="bg-slate-300 rounded-xl p-4 shadow-md">
                    <p class="text-sm text-slate-600 font-semibold">
                        Last workout
                    </p>
                    <p class="text-lg font-bold text-emerald-700">
                        {{(workoutSummary()?.lastWorkoutDate | date) ?? 'N/A'}}
                    </p>
                </div>

                <div class="bg-slate-300 rounded-xl p-4 shadow-md">
                    <p class="text-sm text-slate-600 font-semibold">
                        Favorite exercise type
                    </p>
                    <p class="text-2xl font-bold text-slate-900">
                        @switch(workoutSummary()?.favoriteExerciseType) {
                            @case(1) {
                                Weights
                            }
                            @case(2) {
                                Bodyweight / calisthenics
                            }
                            @case(3) {
                                Cardio
                            }
                            @default {
                                N/A
                            }
                        }
                    </p>
                </div>

                <a routerLink="/workout-form" class="transition-all flex justify-center items-center duration-200 cursor-pointer bg-yellow-500 hover:opacity-70 text-gray-700 shadow-lg font-bold py-3 px-6 rounded-xl text-xl mt-2">
                    <p class="font-semibold self-center">Add New Workout</p>
                </a>
            </div>
        </div>
    </div>
</div>
</div>

@if(isModalOpen()) {
    <app-modal (close)="closeModal()" [data]="buildModal()"></app-modal>

}
