<div class="flex flex-col lg:flex-row gap-6">

    <div class="lg:grow lg:w-2/3 w-full">
        <div class="bg-slate-200 rounded-2xl shadow-xl flex flex-col">
            <div class="flex items-center rounded-t-2xl justify-between bg-linear-to-br from-amber-500 to-amber-400 px-4 py-2 flex-wrap">
                <h2 class="hidden sm:block text-xl font-bold text-slate-800">
                    Workout list
                </h2>

                <div class="flex gap-2 flex-wrap justify-center my-2 sm:my-0">

                    <div>
                        <input
                        [(ngModel)]="search"
                        (input)="onSearchChange($event.target.value)"
                        type="text"
                        placeholder="Enter workout name..."
                        class="rounded-lg px-3 py-1.5 bg-slate-300 text-sm font-semibold focus:outline-none"
                        />
                    </div>

                    <select
                    (change)="loadWorkoutsByQuery(true)"
                    [(ngModel)]="sort"
                    class="rounded-lg px-3 py-1.5 bg-slate-300 text-sm font-semibold focus:outline-none"
                    >
                    <option selected disabled hidden>{{workoutService.getQueryParams().sort}}</option>
                    <option value="Newest">Newest</option>
                    <option value="Oldest">Oldest</option>
                </select>

                <input
                [(ngModel)]="date"
                (input)="loadWorkoutsByQuery(true)"
                type="date"
                class="before:content-['date'] before:text-slate-800 focus:before:content-none rounded-lg px-3 py-1.5 bg-slate-300 text-sm font-semibold focus:outline-none min-w-35"
                />
            </div>
        </div>
        @if(workoutsSource().length === 0) {
            <div class="flex flex-col gap-2 justify-center items-center h-full py-20">
                <ng-icon name="faSolidDumbbell" class="text-5xl sm:text-6xl opacity-50 text-slate-600"></ng-icon>
                <h1 class="text-2xl md:text-4xl font-semibold text-center text-slate-600">No workouts found</h1>
                <p class="text-lg sm:text-xl font-semibold text-center text-slate-600">Adjust your filters and try again</p>
            </div>
        }
        <div class="p-4 overflow-y-auto">


            <div class="flex flex-wrap gap-3">

                @for (workout of workoutsSource(); track workout.id) {
                    <div
                    (click)="getWorkoutDetails(workout.id)"
                    (click)="selectedWorkout = workout"
                    [class]="getWorkoutCardClass()"
                    class="flex items-center bg-slate-300 rounded-xl px-4 py-3 hover:bg-slate-400 hover:scale-[1.01] transition cursor-pointer group shadow-md">

                    <div class="flex flex-col flex-1">
                        <p class="font-semibold text-slate-900 group-hover:underline">
                            {{ workout.name }}
                        </p>
                        <p class="text-sm text-slate-700">
                            {{ workout.exerciseCount }} exercises
                        </p>
                    </div>

                    <div class="flex items-center gap-4 text-sm font-semibold">
                        <div class="hidden lg:flex gap-2 ">
                            @if(workout.hasCardio) {
                                <div class="px-2 py-1 bg-red-600/60 rounded-lg text-gray-800 shadow-all text-lg">
                                    <ng-icon name="faSolidPersonRunning"></ng-icon>
                                </div>

                            }
                            @if(workout.hasWeights) {
                                <div class="px-2 py-1 bg-yellow-500 rounded-lg text-gray-800 shadow-all text-lg">
                                    <ng-icon name="faSolidDumbbell"></ng-icon>
                                </div>
                            }

                            @if(workout.hasBodyWeight) {
                                <div class="px-2 py-1 bg-blue-500/50 rounded-lg text-gray-800 shadow-all text-lg">
                                    <ng-icon name="faSolidChildReaching"></ng-icon>
                                </div>
                            }

                        </div>

                    <div class="min-w-20 flex flex-col gap-2 items-center">

                        <span class="text-emerald-700 self-end">
                            {{workout.workoutDate | date}}
                        </span>


                        <div class="flex gap-2 lg:hidden">

                            @if(workout.hasCardio) {
                                <div class="p-1 px-2 bg-red-600/60 rounded-lg text-gray-800 shadow-all ">
                                    <ng-icon name="faSolidPersonRunning"></ng-icon>
                                </div>

                            }
                            @if(workout.hasWeights) {
                                <div class="p-1 px-2 bg-yellow-500 rounded-lg text-gray-800 shadow-all ">
                                    <ng-icon name="faSolidDumbbell"></ng-icon>
                                </div>
                            }

                            @if(workout.hasBodyWeight) {
                                <div class="p-1 px-2 bg-yellow-500 rounded-lg text-gray-800 shadow-all ">
                                    <ng-icon name="faSolidChildReaching"></ng-icon>
                                </div>
                            }

                        </div>
                    </div>

                </div>
            </div>
        }
    </div>

</div>
@if(workoutsSource().length > 0) {
    <div class="border-b-2 border-yellow-500 my-4 w-[80%] mx-auto mt-auto"></div>

    <div class="bg-slate-300/60 rounded-xl shadow-md mx-4 my-3 px-6 py-3">
        <div class="flex flex-col sm:flex-row gap-4 justify-between items-center">

            <div class="hidden md:flex items-center">
                <span class="font-semibold text-slate-800 bg-yellow-500 px-3 py-1.5 rounded-lg shadow-sm
                transition-colors">
                Page {{page}} of {{totalPages()}}
            </span>
        </div>

        <div class="flex flex-row gap-3 items-center order-first sm:order-0">
            <button
            [disabled]="page == 1"
            (click)="getPreviousPage()"
            class="transition-all flex justify-center items-center duration-200 cursor-pointer bg-yellow-500 hover:opacity-70 hover:scale-105 text-gray-700 shadow-lg font-bold py-2 px-4 rounded-lg disabled:opacity-50 disabled:pointer-events-none">
            <div class="flex items-center">
                <ng-icon name="faSolidChevronLeft" class="text-xl"></ng-icon>
            </div>
        </button>

        <button
        [disabled]="page == totalPages()"
        (click)="getNextPage()"
        class="transition-all flex justify-center items-center duration-200 cursor-pointer bg-yellow-500 hover:opacity-70 hover:scale-105 text-gray-700 shadow-lg font-bold py-2 px-4 rounded-lg disabled:opacity-50 disabled:pointer-events-none">
        <div class="flex items-center justify-center content-center">
            <ng-icon name="faSolidChevronRight" class="text-xl"></ng-icon>
        </div>
    </button>
</div>

<div class="hidden md:flex items-center">
    <span class="font-semibold text-slate-800 bg-yellow-500 px-3 py-1.5 rounded-lg shadow-sm transition-colors">
        Workouts: {{workoutsSource().length}} of {{totalCount()}}
    </span>
</div>
</div>
</div>
}
</div>
</div>

<div class="lg:w-1/3 w-full">
    <div class="flex flex-col h-auto">
        <div class="flex rounded-t-2xl bg-linear-to-br from-amber-500 to-amber-400 w-full px-4 py-2 font-bold">
            <h1 class="text-xl text-slate-800">Summary</h1>
        </div>

        <div class="bg-slate-200 rounded-b-2xl p-4 shadow-2xl">
            <div class="flex flex-col gap-4">
                <div class="bg-slate-300 rounded-xl p-4 shadow-md">
                    <p class="text-sm text-slate-600 font-semibold">
                        Total workouts
                    </p>
                    <p class="text-2xl font-bold text-slate-900">
                        {{workoutSummarySource()?.workoutCount ?? 0}}
                    </p>
                </div>

                <div class="bg-slate-300 rounded-xl p-4 shadow-md">
                    <p class="text-sm text-slate-600 font-semibold">
                        Total exercises
                    </p>
                    <p class="text-2xl font-bold text-slate-900">
                        {{workoutSummarySource()?.exerciseCount ?? 0}}
                    </p>
                </div>

                <div class="bg-slate-300 rounded-xl p-4 shadow-md">
                    <p class="text-sm text-slate-600 font-semibold">
                        Last workout
                    </p>
                    <p class="text-lg font-bold text-emerald-700">
                        {{(workoutSummarySource()?.lastWorkoutDate | date) ?? 'N/A'}}
                    </p>
                </div>

                <div class="bg-slate-300 rounded-xl p-4 shadow-md">
                    <p class="text-sm text-slate-600 font-semibold">
                        Favorite exercise type
                    </p>
                    <p class="text-2xl font-bold text-slate-900">
                        @switch(workoutSummarySource()?.favoriteExerciseType) {
                            @case(1) {
                                Weights
                            }
                            @case(2) {
                                Bodyweight / calisthenics
                            }
                            @case(3) {
                                Cardio
                            }
                            @default {
                                N/A
                            }
                        }
                    </p>
                </div>

                <a routerLink="/workout-form" class="transition-all flex justify-center items-center duration-200 cursor-pointer bg-yellow-500 hover:opacity-70 text-gray-700 shadow-all font-bold py-3 px-6 rounded-xl text-xl mt-2">
                    <p class="font-semibold self-center">Add New Workout</p>
                </a>
            </div>
        </div>
    </div>
</div>
</div>
